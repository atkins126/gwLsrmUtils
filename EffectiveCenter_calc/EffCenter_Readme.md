# EffCenterCalc 

Утилита EffCenterCalc предназначена для расчёта расстояния до эффективного центра детектора гамма-излучения.

Расстояние до эффективного центра можно получить проведя измерения одного и того же источника на двух расстояниях, например, на 5 см и на 25 см.
Расчёт производится по формуле 
$$
EffCenter = (R_2 - \sqrt{n_1/n_2}*R_1)/(\sqrt{n_1/n_2} - 1),
$$
где *R1*, *R2* -- расстояния источник - крышка детектора
*n1*, *n2* -- скорости счёта от одной энергетической линии источника (за вычетом фона) для расстояний *R1* и *R2*, соответственно

## Описание программы

### Методика расчёта расстояния до эффективного центра

Для расчёта программе необходимо, по крайней, мере 2 строчки с данными (2 разных расстояния): 
энергию пика (линии) в кэВ, расстояние до крышки детектора в см, скорость счёта и погрешность скорости счёта.
Дату и нуклид вводить необязательно, если измерения на разных расстояниях были сделаны с небольшим промежутком времени (по сравнению с периодом полураспада). 
Колонка EffCenter информативная. Если ввести большее число строчек для одной энергии (3 и более), то будет произведён расчёт эффективного центра по всем данным и вычислено среднее взвешенное.
Все числа необходимо вводить с "." в качестве десятичного разделителя. 
Для корректного расчёта погрешности эффективного центра нужно вводить погрешность скоростей счёта
После расчёта (кнопка calc) расстояния до эффективного центра детектора сохраняются в efd-файл: EffCenter.efd, используемый SpectraLine. 
Формат этого файла: "энергия в МэВ, расстояние до эффективного центра в см". 
Например:
```
0.66,   2.29
```
Результаты расчёта можно сохранить в любой другой файл, выбрав пункт меню "Save file as ...".
Также можно сохранить в расширенный файл результатов с шапкой, в нём кроме энергии и эффективного центра также сохраняется погрешность эффективного центра 

### Ввод данных, имеющих разную дату измерения

Если измерения имеют разную дату, то необходимо ввести дату и нуклид (например, Cs-137) для того, чтобы пересчитать скорости счёта на одну дату. Период полураспада берётся из файла NuclideCalc.lib, либо, если файла нет, то из встроенных в программу данных о периоде полураспада. Пересчёт на дату произойдёт автоматически при нажатии на кнопку "calc".

### Использование файла ecf (предварительно подготовленные данные)

Данные для расчёта эффективного центра можно предварительно ввести в текстовой файл формата ecf и загрузить в программу из меню File. 
Формат файла ecf: первая строка -- это шапка, а потом идут строки с данными, разделённые табулятором или пробелами. Например:
```
E	R	Count	Date	Nucl
661.661	5	58.66 	01.11.11	Cs-137
```
Набранные или изменённые данные можно сохранить в ecf-файл (меню "Save file as ...")

### Silent-режим (автоматический)

Если при запуске в качестве параметра командной строки exe-файлу указать файл ecf, то программа автоматически считает данные из ecf, пересчитает все значения на дату первого измерения, рассчитает расстояния до эфф центра детектора, сохранит расчёт в EffCenter.efd и закроется. Пример запуска из командной строки:
EffCenterCalc.exe EffCenter.ecf

### Пример

Расчёт эффективного центра для детектора, используя спектры от источника Eu-152, измеренного на расстояниях 5 см и 15 см в один и тот же день.
Вводится в программу либо в файл ecf следующие данные из спектров: энергию пика, расстояние и скорость счёта в пике
```
E	R	Count
121.78	15	8.927
244.7	15	1.657
344.3	15	4.063
444	15	0.367
778.9	15	0.836
964.1	15	0.759
1112.1	15	0.631
1408	15	0.777
121.78	5	54.78
244.7	5	9.465
344.3	5	23.22
444	5	2.048
778.9	5	4.654
964.1	5	4.244
1112.1	5	3.511
1408	5	4.292
```
Если данные вводились в файл, то запустить программу и открыть этот файл. После этого нажать на calc. Будет рассчитаны расстояния до эффективного центра в зависимости от энергии. Сохранить расчёт в файл efd. Результаты расчёта:
```
0.12,   1.77
0.24,   2.19
0.34,   2.19
0.44,   2.34
0.78,   2.36
0.96,   2.33
1.11,   2.36
1.41,   2.41
```


### История версий

0.1.3	Небольшие изменения интерфейса

0.1.2b	Сохранение в расширенный ecf-формат с погрешностью скорости счёта

0.1.1b	Исправление ошибок сохранения и чтения из ecf-файла, небольшие исправления в коде

0.1.0b	первая версия программы